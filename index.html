<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">


<head>
    <title>Eventual</title>
    <meta name="Description" content="Eventual">

    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />

    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="viewport" content="user-scalable=yes, width=device-width, 
          initial-scale=1, maximum-scale=2.5, minimum-scale=.5">

    <!-- PWA -->
    <link  rel="manifest"                              href="manifest.json" />

    <meta name="apple-mobile-web-app-capable"          content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="apple-mobile-web-app-title"            content="Eventual 1.0.0" />
    <meta name="msapplication-TileImage"               content="images/eventual.png" />
    <meta name="msapplication-TileColor"               content="#2F3BA2" />
    <meta name="theme-color"                           content="#ffffff" />

    <link rel="shortcut icon" href="icons/favicon.ico" />
    <link rel="mask-icon"     href="icons/safari-pinned-tab.svg" color="#5bbad5" />

    <!-- External -->
    <script src="external/jquery-3.3.1.min.js"></script>
    <script src="external/popper.min.js"></script>
    <script src="external/bootstrap.min.js"></script>
    <link async href="external/bootstrap.min.css" rel="stylesheet">

    <script src="external/vue.js"></script>
    <script src="external/vis.js"></script>
    <link href="external/vis-timeline-graph2d.min.css" rel="stylesheet" type="text/css" />

    <!-- Internal: timeline -->
    <script src="timeline.js"></script>
</head>


<body>

        <h1>TimeLine</h1>

        <p></p>
	<div id="visualization"></div>

        <p></p>
	<div id="app">
	  {{ message }}
          <br/>
	  <ol>
	    <li v-for="item in items"
	        v-bind:todo="item"
	        v-bind:key="item.id">
	      <input v-model="item.content">
	      <input v-model="item.start">
	      <input v-model="item.end">
	    </li>
	  </ol>
          <button v-on:click="event_add">Add</button>
	</div>


<script type="text/javascript">
    try
    {
        // data
        items = [] ;  
        items_vis = new vis.DataSet() ;
	timeline_data2items(items_vis, items) ;

        // div-visualization
        container = document.getElementById('visualization') ;
        timeline  = timeline_new(items_vis, container) ;

        // vue
	var app = new Vue({
	  el: '#app',

	  data: {
	    message: 'Event list',
	    items: items 
	  },

	  methods: {
	    event_add: function () {

                  var id  = this.items.length + 1 ;
                  var ts1 = new Date() ;
                  var ts2 = new Date() ;
                  ts2.setDate(ts2.getDate() + 1);

	          this.items.push({ 
                      'id':      id,
                      'content': 'event ' + id,
                      'start':   ts1.toISOString(),
                      'end':     ts2.toISOString()
                  }) ;

		  timeline_data2items(items_vis, this.items) ;
		  timeline.fit() ;
	    }
	  }
	}) ;

        // subscribe to any change in the DataSet
        items_vis.on('*', function (event, properties, senderId) {
            //console.log('event', event, properties) ;
              app._data.items = items_vis.get() ;
        }) ;

        // get data...
        $.getJSON("data-1.json", 
                    function(json) {
                          timeline_data2items(items_vis, json) ;
		          timeline.fit() ;
                    }) ;
    }
    catch(err)
    {
          alert("Eventual was improperly used:\n" + err.message + "\n" +
		"\n" +
		"More details:\n" + err.stack);
    }
</script>
<noscript>Your browser does not support JavaScript!</noscript>

</body>

</html>

